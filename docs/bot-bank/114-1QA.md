---
layout: default
title: 114-1 QA
---

{% include mermaid.html %}

### 科目一 (1)邏輯推理(2)軟體工程(3)程式分析

### 第一題
 請回答下列問題:
 #### (一) 假設我們有一個資料表，已經用下列的SQL指創建，並且已經有一些資料加入到資料表中

```sql
CREATE TABLE Users{
    UserID INT PRIMARY KEY IDENTITY(1,1),
    UserName NVARCHAR(50) NOT NULL
    Email NVARCHAR(50) NOT NULL,
}
```
下列是用JAVA+SQL或.NET C#＋SQL寫的一個範例程式，將所有的資料讀出，並且列印出來。
請完成下列JAVA+SQL或.NET C#+SQL程式片段的空格(1)~(7)。
請任選JAVA+SQL或.NET C#+SQL語言作答。{作答時，請註明使用何種語言，並於答案卷上標示題號(1)~(7)}[16分]
[第1~2小格，每格3分; 第3~7小格，每格2分]

//JAVA+SQL
```java
//JAVA
```
//.NET C#+SQL
```csharp
using System;
using System.Data.SqlClient;
class ReadUsers{
    static void Main(){
        string connectionString ="Server=localhost;Database=testdb;user Id=sa;Password=your_password;";
        string sql="<(1)>";
        using(SqlConnection conn=new SqlConnection(connectionString)){
            conn.Open();
            using(SqlCommand cmd = <(2)>)
            using(SqlDataReader reader = <(3)>){
                while(<(4)>){
                    int id= <5>;
                    string name = <6>;
                    string email= <7>;
                    Console.WriteLine($"ID={id},Name={name},Email={email}");
                }
            }
        }
    }
}
```
<details markdown="1">
  <summary>顯示答案</summary>

### (一) 填空 (1)～(7)

```csharp
using System;
using System.Data.SqlClient;

class ReadUsers {
    static void Main() {
        string connectionString = "Server=localhost;Database=testdb;user Id=sa;Password=your_password;";
        string sql = "<(1)>";  // (1)
        using (SqlConnection conn = new SqlConnection(connectionString)) {
            conn.Open();
            using (SqlCommand cmd = <(2)>)                 // (2)
            using (SqlDataReader reader = <(3)>) {         // (3)
                while (<(4)>) {                            // (4)
                    int id = <(5)>;                        // (5)
                    string name = <(6)>;                   // (6)
                    string email = <(7)>;                  // (7)
                    Console.WriteLine($"ID={id},Name={name},Email={email}");
                }
            }
        }
    }
}

```

答案：

>1. SELECT UserID, UserName, Email FROM Users
>2. new SqlCommand(sql, conn)
>3. cmd.ExecuteReader()
>4. reader.Read()
>5. reader.GetInt32(reader.GetOrdinal("UserID"))
>6. reader.GetString(reader.GetOrdinal("UserName"))
>7. reader.GetString(reader.GetOrdinal("Email"))

</details>

#### (二) 在SQL資料庫中要安全更新資料時，要特別注意以下三項:<br>
1.永遠使用參數化查詢(?或@參數名)<br>
2.永遠使用交易(Transcation)<br>
3.檢查ExecuteUpdate/Execute回傳的筆數。<br>
請說明此三項之目的為何?[9分]

<details markdown="1">
  <summary>顯示答案</summary>
  <br>

> 1. 永遠使用參數化查詢
>- 目的：防止 SQL Injection、自動正確轉義與型別繫結、提升計畫快取重用率（效能較佳）。
> 2. 永遠使用交易 (Transaction)
>- 目的：確保 原子性（全成或全不成）、一致性、可回復性（失敗可 ROLLBACK）、以及在多筆/跨表更新時維持資料完整性與適當的隔離。
> 3. 檢查 ExecuteNonQuery/Execute 的回傳筆數
>- 目的：確認實際影響的列數是否符合預期（如應為 1 筆）。可偵測條件錯誤（0 筆）、避免誤更新過多資料（>1 筆），也可用於 樂觀式並發控制（預期 1 筆卻為 0 代表資料已被他人修改）。

小提醒（非作答必要）：CREATE TABLE 在 T-SQL 應使用括號 () 而非 {}，且每欄位間需以逗號分隔。
<br>

</details>
---

### 第二題
下列SQL Store Procedure is_prime() 計算n是否為質數 是質數則回傳TRUE、不是質數則回傳FALSE:<br>
請利用JAVA或C#程式上使用SQL 「is_prime()」，輸出1~N中的所有質數。並完成程式片段的空格(1)~(7)使程式運作正確。<br>
請任選JAVA或C#程式作答。<br>{作答時，請註明使用何種語言，並於答案卷上標示題號(1)~(7)}[25分][第1～4小格，每格4分：第5~7格，每格3分]

```sql
// SQL Store Procedure
DELIMITER $$

CREATE FUNCTION is_prime(n INT)RETURNS BOOLEAN
DETERMINISTIC
BEGIN
    DECLARE i INT DEFAULT 2;
    
    IF n <=1 THEN
        RETURN <(1)>;
    END IF;

    WHILE i*i <=n  DO
        IF MOD(n,i)=0 THEN
            RETURN <(2)>;
        END IF
        SET i= i+1;
    END WHILE;
    RETURN <(3)>;
END$$

DELIMITER;
```

```java
//JAVA
```
```csharp
//C#
using System;
using MySql.Data.MySqlClient;
class PrimeSQLChecker{
    static void Main(){
        Console.Write("N:");
        int N = int.Parse(Console.ReadLine());
        string connStr = "server=localhost;database=_db;user=_user;password=_passwd;";
        using(var conn= new MySqlConnection(connStr)){
            try{
                conn.Open();
                for(int=2;<(4)>;i++){
                    using(var cmd = new MySqlCommand("<(5)>",conn)){
                        cmd.Parameters.AddWithValue("@n",<(6)>);
                        using(var reader= cmd.ExecuteReader()){
                            if(reader.Read()<(7)>reader.GetBoolean("result")){
                                Console.Write(i+"");
                            }
                        }
                    }
                }
            }catch(Exception ex){
                Console.WriteLine(ex.Message);
            }
        } 
    }
}
```
<details markdown="1">
  <summary>顯示答案</summary>

答案：
> 1. FALSE
> 2. FALSE
> 3. TRUE
> 4. i <= N
> 5. SELECT is_prime(@n) AS result
> 6. i
> 7. &&

</details>

---

### 第三題

請回答下列問題:
(一) 請以JAVA或C#語言來撰寫程式，可以讓使用者輸入兩個整數，並計算其和、差、積、商及餘數結果。<br>
請任選JAVA或C#語言作答。<br> [作答時，請註明使用何種語言][13分]<br>
(二)下列程式是用JAVA或C#語言撰寫一個程式，可以讓使用者輸入任何英文字，並且將大寫轉換成小寫，將小寫轉換成大寫。請完成下列
```java
//JAVA
```
```csharp
//C#
using System
class ToggleCase
{
    static void Main()
    {
        Console.Write("請輸入英文文字");
        string input= <(1)>;
        char[] chars = <(2)>;
        for(int i=0; <(3)>)
        {
            if(<(4)>)
            {
                <(5)>
            }
            else if(char.IsLower(chars[i])){
                <(6)>
            }
        }        
    }
    string result = new string(chars);
    Console.WriteLine("轉換結果:"+result);
}
```
<details markdown="1">
  <summary>顯示答案</summary>

### (一) 兩數加減乘除與餘數（C#）

```csharp
using System;

class CalcBasic {
    static void Main() {
        Console.Write("請輸入兩個整數（以空白分隔）: ");
        var parts = Console.ReadLine()?.Split(new[] { ' ', '\t' }, StringSplitOptions.RemoveEmptyEntries);
        int a = int.Parse(parts[0]);
        int b = int.Parse(parts[1]);

        Console.WriteLine($"和: {a + b}");
        Console.WriteLine($"差: {a - b}");
        Console.WriteLine($"積: {a * b}");
        if (b != 0) {
            Console.WriteLine($"商: {a / b}");
            Console.WriteLine($"餘數: {a % b}");
        } else {
            Console.WriteLine("商: 除數為 0，無法計算");
            Console.WriteLine("餘數: 除數為 0，無法計算");
        }
    }
}
```
---

### (一) 英文字母大小寫互換（C#）—填空與完整程式

填空 (1)～(6) 答案：
> 1. Console.ReadLine()
> 2. input.ToCharArray()
> 3. i < chars.Length; i++
> 4. char.IsUpper(chars[i])
> 5. chars[i] = char.ToLower(chars[i]);
> 6. chars[i] = char.ToUpper(chars[i]);

整理後的可執行版本：
```csharp
using System;

class ToggleCase {
    static void Main() {
        Console.Write("請輸入英文文字: ");
        string input = Console.ReadLine();                // (1)
        char[] chars = input.ToCharArray();               // (2)

        for (int i = 0; i < chars.Length; i++) {          // (3)
            if (char.IsUpper(chars[i])) {                 // (4)
                chars[i] = char.ToLower(chars[i]);        // (5)
            } else if (char.IsLower(chars[i])) {
                chars[i] = char.ToUpper(chars[i]);        // (6)
            }
        }

        string result = new string(chars);
        Console.WriteLine("轉換結果: " + result);
    }
}
```
</details>
---

### 第四題

下列以JAVA 與C# 程式實作汽車(Car)的各種移動器(Mover)，包含陸地用輪子(Wheel)、和飛行用飛翼(Wing)。<br>

(作答時，請註明使用何種語言)<br>
(一) 請說明執行程式碼42行「Car c1=new Car(m1);」、43行「c1.move(5);」的運作流程，包含動態多型(Dynamic Polymorphism)的程式碼邏輯。[10分]

(二) 請說明程式的輸出。[10分]<br>
(三) 請說明程式中類別之間的關係。[5分]<br>

```java
//JAVA
```
```csharp
using System;//C#
abstract class Mover{
    private string name;
    private int speed;
    private int distance;
    public Mover(string _n, int_s){
        name= _n;
        speed = _s;
        distance = 0;
    }
    public int print(int _m){
        distance +=go(_m);
        Console.WriteLine($"{name}:{distance}");
        return distance;
    }
    protected int getSpeed(){ return speed;}
    protected abstract int go(int_m);
}
class Wheel:Mover{
    public Wheel(string _n, int_s):base(_n, _s){}
    protected override int go (int_m){return _m * getSpeed();}
}
class Wing:Mover{
    public Wheel(string _n, int_s):base(_n, _s){}
    protected override int go (int_m){return(_m -3) * getSpeed();}
}
class Car{
    private Mover_mover;
    private int distance;
    public Car(Mover _m){
        _mover=_m;
        distance=();
    }
    public void move(int _m){distance+=_mover.print(_m);}
    public void setMover(Mover _m){_mover=_m;}
    public void print(){Console.WriteLine($"total:{distance}");}
}
class Vehicle{
    public static void Main(string[] args){
        Mover m1 = new Wheel("FourWheel",5);
        Mover m1 = new Wing("TurboFly",50);
        Car c1= new Car(m1); // 42行 (一)
        c1.move(5); // 43行 (一)
        c1.print();
        c1.setMover(m2);
        c1.move(5);
        c1.print();
    }
}
```

<details markdown="1">
  <summary>顯示答案</summary>
<br>  
(一) 42、43 行的「動態多型」執行流程（C#）

以題目語意（修正筆誤後）理解下列兩行：
```csharp
Car c1 = new Car(m1);  // 42 行
c1.move(5);            // 43 行
```
- m1 的靜態型別是 Mover，實際（執行期）型別是 Wheel。
- Car 內部以欄位（如 _mover: Mover）持有一個 Mover 參考。這是「has-a（聚合/組合）」關係。
- 呼叫 c1.move(5) 時，Car.move 實作通常會呼叫 _mover.print(5)。
在 Mover.print(int m) 裡會執行：

> 1. distance += go(m);
> 2. Console.WriteLine($"{name}:{distance}");
> 3. 回傳 distance

- 關鍵：go(m) 是 Mover 的 abstract 虛擬方法，實作由子類別覆寫（Wheel.go 或 Wing.go）。
因此實際呼叫的是 執行期型別 對應的 go：

>  * 若 _mover 目前是 Wheel，則呼叫 Wheel.go(m)（回傳 m * speed）。
>  * 若之後 setMover(m2) 把策略換成 Wing，再呼叫 move(5) 時，動態繫結會改呼叫 Wing.go(m)（回傳 (m-3) * speed）。

總結：Car 只依賴抽象型別 Mover，真正被執行的 go 版本在 執行期由物件的實際型別決定，這就是「動態多型（動態繫結）」。

---
<br>
(二) 程式輸出說明（依題目意圖）

假設資料如下（與題目敘述一致）：
```csharp
Mover m1 = new Wheel("FourWheel", 5);
Mover m2 = new Wing("TurboFly", 50);

Car c1 = new Car(m1);   // c1 先用輪子
c1.move(5);             // 由 Wheel.go(5) = 5 * 5 = 25
c1.print();             // 車總里程：25

c1.setMover(m2);        // 換成機翼
c1.move(5);             // 由 Wing.go(5) = (5 - 3) * 50 = 100
c1.print();             // 車總里程：25 + 100 = 125
```
逐步輸出：
```makefile
FourWheel:25
total:25
TurboFly:100
total:125
```
第一行 FourWheel:25 來自 Mover.print 在 Wheel 下的印出。
total:25 是 Car.print（車的累計距離）。
換成 Wing 後，Mover.print 印 TurboFly:100。
最後 Car.print 印出累計的 total:125。

---
<br>
(三) 類別之間的關係

* 繼承（is-a）：Wheel、Wing 繼承 抽象類別 Mover，並各自覆寫 go(m)。
* 聚合/組合（has-a）：Car 持有 一個 Mover 參考欄位，透過 setMover 可動態更換移動策略。

* 設計模式面向：

> * Mover.print() 先做共通流程，再呼叫抽象步驟 go(m) → 這是 Template Method 的型態。
> * Car 以 setMover() 注入/替換不同實作（Wheel/Wing）→ 這是 Strategy 策略模式 的精神。

* 多型：Car 只依賴 Mover 抽象，實際執行的是子類覆寫的 go（動態多型）。

</details>